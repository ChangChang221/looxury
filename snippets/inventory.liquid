{%- comment -%}
----------------------------------------------------------------------------------------------------------------------
PRODUCT INVENTORY COMPONENT
----------------------------------------------------------------------------------------------------------------------

This component is used to display the inventory of a given product

********************************************
Supported variables
********************************************

* product: the product from which the inventory is extracted (required)
* low_threshold: the inventory quantity threshold below which the inventory is shown as "red"
* form_id: if specified, define the form ID linked to this input
{%- endcomment -%}

<variant-inventory {% if form_id %}form="{{ form_id }}"{% endif %}>
  {%- for variant in product.variants -%}
     {%- if variant == product.selected_or_first_available_variant -%}
      {%- assign variant_selected = true -%}
    {%- else -%}
      {%- assign variant_selected = false -%}
    {%- endif -%}

    {%- if variant_selected -%}
      {%- if variant.available and variant.inventory_quantity > 0 -%}
        <span class="text-with-icon text-success">
          {%- render 'icon' with 'success' -%}
          {{ 'In stock' }}
        </span>
        <span>Ship immediately</span>
      {%- else -%}
        <span class="text-with-icon text-error">
          {%- render 'icon' with 'warning' -%}
          Pre-Order
        </span>
        {%- assign delay_days = preorder_ship_days -%}
        {%- assign delay_seconds = delay_days | times: 86400 -%}
        {%- capture ship_date -%}
          {{ 'now' | date: "%s" | plus: delay_seconds | date: "%B %d, %Y" }}
        {%- endcapture -%}
        
        <span>Goods will be shipped from date {{ ship_date }}</span>
      {%- endif -%}
    {%- endif -%}
  {%- endfor -%}
</variant-inventory>